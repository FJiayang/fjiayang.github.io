<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    Kubernetes基础命令学习 | F嘉阳
</title>
<link rel="shortcut icon" href="https://fjiayang.github.io//favicon.ico?v=1575361648842">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://fjiayang.github.io//styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://fjiayang.github.io//media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://fjiayang.github.io/">
                <img class="avatar" src="https://fjiayang.github.io//images/avatar.png?v=1575361648842" alt="">
            </a>
            <div class="site-title">
                <h1>
                    F嘉阳
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            Kubernetes基础命令学习
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2019-10-20</time>
                            
                                <a href="https://fjiayang.github.io//tag/VwGnvPo1M" class="post-tag i-tag
                            i-tag-other_2">
                            #学习
                        </a>
                                
                                <a href="https://fjiayang.github.io//tag/yb4HlP89R" class="post-tag i-tag
                            i-tag-info">
                            #Kubernetes
                        </a>
                                
                        </div>
                        
                            <div class="post-feature-image" style="background-image: url('https://s2.ax1x.com/2019/11/27/QC2UuF.png')"></div>
                            
                                <div class="post-content">
                                    <h2 id="配置命令语法提示">配置命令语法提示</h2>
<p>执行命令查看指南</p>
<!-- more -->
<pre><code class="language-bash">$ kubectl completion -h
Output shell completion code for the specified shell (bash or zsh). The shell code must be evaluated to provide
interactive completion of kubectl commands.  This can be done by sourcing it from the .bash_profile.

 Detailed instructions on how to do this are available here:
https://kubernetes.io/docs/tasks/tools/install-kubectl/#enabling-shell-autocompletion

 Note for zsh users: [1] zsh completions are only supported in versions of zsh &gt;= 5.2

Examples:
  # Installing bash completion on macOS using homebrew
  ## If running Bash 3.2 included with macOS
  brew install bash-completion
  ## or, if running Bash 4.1+
  brew install bash-completion@2
  ## If kubectl is installed via homebrew, this should start working immediately.
  ## If you've installed via other means, you may need add the completion to your completion directory
  kubectl completion bash &gt; $(brew --prefix)/etc/bash_completion.d/kubectl


  # Installing bash completion on Linux
  ## If bash-completion is not installed on Linux, please install the 'bash-completion' package
  ## via your distribution's package manager.
  ## Load the kubectl completion code for bash into the current shell
  source &lt;(kubectl completion bash)
  ## Write bash completion code to a file and source if from .bash_profile
  kubectl completion bash &gt; ~/.kube/completion.bash.inc
  printf &quot;
  # Kubectl shell completion
  source '$HOME/.kube/completion.bash.inc'
  &quot; &gt;&gt; $HOME/.bash_profile
  source $HOME/.bash_profile

  # Load the kubectl completion code for zsh[1] into the current shell
  source &lt;(kubectl completion zsh)
  # Set the kubectl completion code for zsh[1] to autoload on startup
  kubectl completion zsh &gt; &quot;${fpath[1]}/_kubectl&quot;

Usage:
  kubectl completion SHELL [options]

Use &quot;kubectl options&quot; for a list of global command-line options (applies to all commands).
</code></pre>
<p>按照指南操作即可</p>
<h2 id="配置多个上下文环境">配置多个上下文环境</h2>
<p>查看当前上下文配置</p>
<pre><code class="language-bash">$ kubectl config get-contexts
CURRENT   NAME       CLUSTER    AUTHINFO           NAMESPACE
*         minikube   minikube   minikube
</code></pre>
<p>编辑<code>~/.kube/config</code>文件新增需要的上下文配置即可，配置完成后查看上下文信息</p>
<pre><code class="language-bash">$ kubectl config get-contexts
CURRENT   NAME       CLUSTER    AUTHINFO           NAMESPACE
          kubeadm    kubeadm    kubernetes-admin
*         minikube   minikube   minikube
</code></pre>
<p>切换上下文</p>
<pre><code class="language-bash">$ kubectl config use-context kubeadm
Switched to context &quot;kubeadm&quot;.
</code></pre>
<p>再次查看，可见切换成功</p>
<pre><code class="language-bash">$ kubectl config get-contexts
CURRENT   NAME       CLUSTER    AUTHINFO           NAMESPACE
*         kubeadm    kubeadm    kubernetes-admin
          minikube   minikube   minikube
</code></pre>
<h2 id="pod相关操作">Pod相关操作</h2>
<h3 id="默认查看default命名空间的pod">默认查看<code>default</code>命名空间的Pod</h3>
<pre><code class="language-bash">$ kubectl get pod
NAME                                READY   STATUS    RESTARTS   AGE
nginx-deployment-54f57cf6bf-pznmh   1/1     Running   0          52s
nginx-deployment-54f57cf6bf-r9q89   1/1     Running   0          52s
</code></pre>
<h3 id="查看所有命名空间的pod">查看所有命名空间的Pod</h3>
<pre><code class="language-bash">$ kubectl get pod --all-namespaces
NAMESPACE     NAME                                 READY   STATUS    RESTARTS   AGE
kube-system   coredns-58cc8c89f4-c297b             1/1     Running   0          10m
kube-system   coredns-58cc8c89f4-spzhj             1/1     Running   0          10m
kube-system   etcd-k8s-master                      1/1     Running   0          9m57s
kube-system   kube-apiserver-k8s-master            1/1     Running   0          10m
kube-system   kube-controller-manager-k8s-master   1/1     Running   0          9m58s
kube-system   kube-flannel-ds-amd64-6fwg5          1/1     Running   0          5m
kube-system   kube-flannel-ds-amd64-6rchg          1/1     Running   0          9m12s
kube-system   kube-flannel-ds-amd64-z4plh          1/1     Running   0          4m54s
kube-system   kube-proxy-cdcs4                     1/1     Running   0          5m
kube-system   kube-proxy-nlmbb                     1/1     Running   0          4m54s
kube-system   kube-proxy-xlb62                     1/1     Running   0          10m
kube-system   kube-scheduler-k8s-master            1/1     Running   0          10m
</code></pre>
<h3 id="指定pod对应的app名称">指定Pod对应的app名称</h3>
<pre><code class="language-bash">$ kubectl get pod -l app=nginx
NAME                                READY   STATUS    RESTARTS   AGE
nginx-deployment-54f57cf6bf-pznmh   1/1     Running   0          58s
nginx-deployment-54f57cf6bf-r9q89   1/1     Running   0          58s
</code></pre>
<h3 id="查看更多信息">查看更多信息</h3>
<pre><code class="language-bash">$ kubectl get deployment -o wide
NAME               READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS   IMAGES        SELECTOR
nginx-deployment   2/2     2            2           64s   nginx        nginx:1.7.9   app=nginx
</code></pre>
<h3 id="查看pod详细信息">查看Pod详细信息</h3>
<pre><code class="language-bash">$ kubectl describe pod
Name:         nginx-deployment-54f57cf6bf-67llv
Namespace:    default
Priority:     0
Node:         k8s-node1/10.0.2.15
Start Time:   Sun, 20 Oct 2019 10:19:42 +0800
Labels:       app=nginx
              pod-template-hash=54f57cf6bf
Annotations:  &lt;none&gt;
Status:       Running
IP:           172.100.1.3
IPs:
  IP:           172.100.1.3
Controlled By:  ReplicaSet/nginx-deployment-54f57cf6bf
Containers:
  nginx:
    Container ID:   docker://ffd4b4fa3fd4678a61797cfdcba31ea2b0b36459b65a95100484eda4be286b9f
    Image:          nginx:1.7.9
    Image ID:       docker-pullable://nginx@sha256:e3456c851a152494c3e4ff5fcc26f240206abac0c9d794affb40e0714846c451
    Port:           80/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Sun, 20 Oct 2019 10:19:45 +0800
    Ready:          True
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-zjpq9 (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  default-token-zjpq9:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-zjpq9
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type    Reason     Age        From                Message
  ----    ------     ----       ----                -------
  Normal  Scheduled  &lt;unknown&gt;  default-scheduler   Successfully assigned default/nginx-deployment-54f57cf6bf-67llv to k8s-node1
  Normal  Pulled     46s        kubelet, k8s-node1  Container image &quot;nginx:1.7.9&quot; already present on machine
  Normal  Created    46s        kubelet, k8s-node1  Created container nginx
  Normal  Started    45s        kubelet, k8s-node1  Started container nginx


Name:         nginx-deployment-54f57cf6bf-r9q89
Namespace:    default
Priority:     0
Node:         k8s-node2/10.0.2.15
Start Time:   Sun, 20 Oct 2019 10:17:24 +0800
Labels:       app=nginx
              pod-template-hash=54f57cf6bf
Annotations:  &lt;none&gt;
Status:       Running
IP:           172.100.2.3
IPs:
  IP:           172.100.2.3
Controlled By:  ReplicaSet/nginx-deployment-54f57cf6bf
Containers:
  nginx:
    Container ID:   docker://61894b3762d723eabe2510284bb107098bdbcb8da4f841eea863a9c7a59c5806
    Image:          nginx:1.7.9
    Image ID:       docker-pullable://nginx@sha256:e3456c851a152494c3e4ff5fcc26f240206abac0c9d794affb40e0714846c451
    Port:           80/TCP
    Host Port:      0/TCP
    State:          Running
      Started:      Sun, 20 Oct 2019 10:18:08 +0800
    Ready:          True
    Restart Count:  0
    Environment:    &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-zjpq9 (ro)
Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
Volumes:
  default-token-zjpq9:
    Type:        Secret (a volume populated by a Secret)
    SecretName:  default-token-zjpq9
    Optional:    false
QoS Class:       BestEffort
Node-Selectors:  &lt;none&gt;
Tolerations:     node.kubernetes.io/not-ready:NoExecute for 300s
                 node.kubernetes.io/unreachable:NoExecute for 300s
Events:
  Type    Reason     Age        From                Message
  ----    ------     ----       ----                -------
  Normal  Scheduled  &lt;unknown&gt;  default-scheduler   Successfully assigned default/nginx-deployment-54f57cf6bf-r9q89 to k8s-node2
  Normal  Pulling    3m4s       kubelet, k8s-node2  Pulling image &quot;nginx:1.7.9&quot;
  Normal  Pulled     2m24s      kubelet, k8s-node2  Successfully pulled image &quot;nginx:1.7.9&quot;
  Normal  Created    2m22s      kubelet, k8s-node2  Created container nginx
  Normal  Started    2m22s      kubelet, k8s-node2  Started container nginx
</code></pre>
<h2 id="deployment相关操作">Deployment相关操作</h2>
<h3 id="部署deployment">部署Deployment</h3>
<pre><code class="language-bash">$ kubectl create -f nginx_deployment.yml
deployment.apps/nginx-deployment created
</code></pre>
<h3 id="升级deployment">升级Deployment</h3>
<p><code>apply</code>兼有<code>create</code>的语义，故也可直接使用<code>apply</code>创建\部署<code>deployment</code></p>
<pre><code class="language-bash">$ kubectl apply -f nginx_deployment_scale.yml
deployment.apps/nginx-deployment configured
</code></pre>
<h3 id="查看deployment更多信息">查看Deployment更多信息</h3>
<pre><code class="language-bash">$ kubectl get deployment -o wide
NAME               READY   UP-TO-DATE   AVAILABLE   AGE     CONTAINERS   IMAGES      SELECTOR
nginx-deployment   2/2     2            2           5m28s   nginx        nginx:1.8   app=nginx
</code></pre>
<h3 id="查看详细信息">查看详细信息</h3>
<pre><code class="language-bash">$ kubectl describe deployments.apps
Name:                   nginx-deployment
Namespace:              default
CreationTimestamp:      Sun, 20 Oct 2019 10:17:24 +0800
Labels:                 &lt;none&gt;
Annotations:            deployment.kubernetes.io/revision: 3
                        kubectl.kubernetes.io/last-applied-configuration:
                          {&quot;apiVersion&quot;:&quot;apps/v1&quot;,&quot;kind&quot;:&quot;Deployment&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;name&quot;:&quot;nginx-deployment&quot;,&quot;namespace&quot;:&quot;default&quot;},&quot;spec&quot;:{&quot;replica...
Selector:               app=nginx
Replicas:               2 desired | 2 updated | 2 total | 2 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=nginx
  Containers:
   nginx:
    Image:        nginx:1.9.1
    Port:         80/TCP
    Host Port:    0/TCP
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Progressing    True    NewReplicaSetAvailable
  Available      True    MinimumReplicasAvailable
OldReplicaSets:  &lt;none&gt;
NewReplicaSet:   nginx-deployment-56f8998dbc (2/2 replicas created)
Events:
  Type    Reason             Age                  From                   Message
  ----    ------             ----                 ----                   -------
  Normal  ScalingReplicaSet  22m                  deployment-controller  Scaled up replica set nginx-deployment-54f57cf6bf to 2
  Normal  ScalingReplicaSet  18m                  deployment-controller  Scaled up replica set nginx-deployment-9f46bb5 to 1
  Normal  ScalingReplicaSet  17m                  deployment-controller  Scaled down replica set nginx-deployment-54f57cf6bf to 1
  Normal  ScalingReplicaSet  17m                  deployment-controller  Scaled up replica set nginx-deployment-9f46bb5 to 2
  Normal  ScalingReplicaSet  16m                  deployment-controller  Scaled down replica set nginx-deployment-54f57cf6bf to 0
  Normal  ScalingReplicaSet  15m                  deployment-controller  Scaled up replica set nginx-deployment-9f46bb5 to 4
  Normal  ScalingReplicaSet  12m                  deployment-controller  Scaled down replica set nginx-deployment-9f46bb5 to 3
  Normal  ScalingReplicaSet  6m25s                deployment-controller  Scaled up replica set nginx-deployment-56f8998dbc to 1
  Normal  ScalingReplicaSet  5m43s                deployment-controller  Scaled down replica set nginx-deployment-9f46bb5 to 2
  Normal  ScalingReplicaSet  63s (x6 over 5m43s)  deployment-controller  (combined from similar events): Scaled down replica set nginx-deployment-56f8998dbc to 2
</code></pre>
<h2 id="node相关">Node相关</h2>
<h3 id="查看node">查看Node</h3>
<pre><code class="language-bash">$ kubectl get nodes
NAME         STATUS   ROLES    AGE   VERSION
k8s-master   Ready    master   24m   v1.16.2
k8s-node1    Ready    &lt;none&gt;   18m   v1.16.2
k8s-node2    Ready    &lt;none&gt;   18m   v1.16.2
</code></pre>
<h3 id="查看更多信息-2">查看更多信息</h3>
<pre><code class="language-bash">$ kubectl get nodes -o wide
NAME         STATUS   ROLES    AGE   VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE                KERNEL-VERSION               CONTAINER-RUNTIME
k8s-master   Ready    master   24m   v1.16.2   10.0.2.15     &lt;none&gt;        CentOS Linux 7 (Core)   3.10.0-957.12.2.el7.x86_64   docker://18.9.8
k8s-node1    Ready    &lt;none&gt;   18m   v1.16.2   10.0.2.15     &lt;none&gt;        CentOS Linux 7 (Core)   3.10.0-957.12.2.el7.x86_64   docker://18.9.8
k8s-node2    Ready    &lt;none&gt;   18m   v1.16.2   10.0.2.15     &lt;none&gt;        CentOS Linux 7 (Core)   3.10.0-957.12.2.el7.x86_64   docker://18.9.8
</code></pre>
<h3 id="查看标签">查看标签</h3>
<pre><code class="language-bash">$ kubectl get nodes --show-labels
NAME         STATUS   ROLES    AGE   VERSION   LABELS
k8s-master   Ready    master   24m   v1.16.2   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=k8s-master,kubernetes.io/os=linux,node-role.kubernetes.io/master=
k8s-node1    Ready    &lt;none&gt;   18m   v1.16.2   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=k8s-node1,kubernetes.io/os=linux
k8s-node2    Ready    &lt;none&gt;   18m   v1.16.2   beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/arch=amd64,kubernetes.io/hostname=k8s-node2,kubernetes.io/os=linux
</code></pre>
<h3 id="设置角色标签">设置角色标签</h3>
<pre><code class="language-bash">$ kubectl label nodes k8s-node1 node-role.kubernetes.io/worker=
node/k8s-node1 labeled
</code></pre>
<h3 id="查看详细信息-2">查看详细信息</h3>
<pre><code class="language-bash">$ kubectl describe nodes
Name:               k8s-master
Roles:              master
Labels:             beta.kubernetes.io/arch=amd64
                    beta.kubernetes.io/os=linux
                    kubernetes.io/arch=amd64
                    kubernetes.io/hostname=k8s-master
                    kubernetes.io/os=linux
                    node-role.kubernetes.io/master=
Annotations:        flannel.alpha.coreos.com/backend-data: {&quot;VtepMAC&quot;:&quot;32:38:c5:18:f0:ed&quot;}
                    flannel.alpha.coreos.com/backend-type: vxlan
                    flannel.alpha.coreos.com/kube-subnet-manager: true
                    flannel.alpha.coreos.com/public-ip: 10.0.2.15
                    kubeadm.alpha.kubernetes.io/cri-socket: /var/run/dockershim.sock
                    node.alpha.kubernetes.io/ttl: 0
                    volumes.kubernetes.io/controller-managed-attach-detach: true
CreationTimestamp:  Sun, 20 Oct 2019 10:05:02 +0800
Taints:             node-role.kubernetes.io/master:NoSchedule
Unschedulable:      false
Conditions:
  Type             Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
  ----             ------  -----------------                 ------------------                ------                       -------
  MemoryPressure   False   Sun, 20 Oct 2019 10:27:46 +0800   Sun, 20 Oct 2019 10:05:02 +0800   KubeletHasSufficientMemory   kubelet has sufficient memory available
  DiskPressure     False   Sun, 20 Oct 2019 10:27:46 +0800   Sun, 20 Oct 2019 10:05:02 +0800   KubeletHasNoDiskPressure     kubelet has no disk pressure
  PIDPressure      False   Sun, 20 Oct 2019 10:27:46 +0800   Sun, 20 Oct 2019 10:05:02 +0800   KubeletHasSufficientPID      kubelet has sufficient PID available
  Ready            True    Sun, 20 Oct 2019 10:27:46 +0800   Sun, 20 Oct 2019 10:07:42 +0800   KubeletReady                 kubelet is posting ready status
Addresses:
  InternalIP:  10.0.2.15
  Hostname:    k8s-master
Capacity:
 cpu:                2
 ephemeral-storage:  41921540Ki
 hugepages-2Mi:      0
 memory:             1882144Ki
 pods:               110
Allocatable:
 cpu:                2
 ephemeral-storage:  38634891201
 hugepages-2Mi:      0
 memory:             1779744Ki
 pods:               110
System Info:
 Machine ID:                 d74c50274729456aad2a6198de9863b3
 System UUID:                D74C5027-4729-456A-AD2A-6198DE9863B3
 Boot ID:                    fb2ea7bd-afb2-4051-afb7-78d9f59ec6f6
 Kernel Version:             3.10.0-957.12.2.el7.x86_64
 OS Image:                   CentOS Linux 7 (Core)
 Operating System:           linux
 Architecture:               amd64
 Container Runtime Version:  docker://18.9.8
 Kubelet Version:            v1.16.2
 Kube-Proxy Version:         v1.16.2
PodCIDR:                     172.100.0.0/24
PodCIDRs:                    172.100.0.0/24
Non-terminated Pods:         (8 in total)
  Namespace                  Name                                  CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE
  ---------                  ----                                  ------------  ----------  ---------------  -------------  ---
  kube-system                coredns-58cc8c89f4-c297b              100m (5%)     0 (0%)      70Mi (4%)        170Mi (9%)     23m
  kube-system                coredns-58cc8c89f4-spzhj              100m (5%)     0 (0%)      70Mi (4%)        170Mi (9%)     23m
  kube-system                etcd-k8s-master                       0 (0%)        0 (0%)      0 (0%)           0 (0%)         22m
  kube-system                kube-apiserver-k8s-master             250m (12%)    0 (0%)      0 (0%)           0 (0%)         22m
  kube-system                kube-controller-manager-k8s-master    200m (10%)    0 (0%)      0 (0%)           0 (0%)         22m
  kube-system                kube-flannel-ds-amd64-6rchg           100m (5%)     100m (5%)   50Mi (2%)        50Mi (2%)      21m
  kube-system                kube-proxy-xlb62                      0 (0%)        0 (0%)      0 (0%)           0 (0%)         23m
  kube-system                kube-scheduler-k8s-master             100m (5%)     0 (0%)      0 (0%)           0 (0%)         22m
Allocated resources:
  (Total limits may be over 100 percent, i.e., overcommitted.)
  Resource           Requests     Limits
  --------           --------     ------
  cpu                850m (42%)   100m (5%)
  memory             190Mi (10%)  390Mi (22%)
  ephemeral-storage  0 (0%)       0 (0%)
Events:
  Type    Reason                   Age                From                    Message
  ----    ------                   ----               ----                    -------
  Normal  NodeHasSufficientMemory  23m (x8 over 23m)  kubelet, k8s-master     Node k8s-master status is now: NodeHasSufficientMemory
  Normal  NodeHasNoDiskPressure    23m (x8 over 23m)  kubelet, k8s-master     Node k8s-master status is now: NodeHasNoDiskPressure
  Normal  NodeHasSufficientPID     23m (x7 over 23m)  kubelet, k8s-master     Node k8s-master status is now: NodeHasSufficientPID
  Normal  Starting                 23m                kube-proxy, k8s-master  Starting kube-proxy.


Name:               k8s-node1
Roles:              &lt;none&gt;
Labels:             beta.kubernetes.io/arch=amd64
                    beta.kubernetes.io/os=linux
                    kubernetes.io/arch=amd64
                    kubernetes.io/hostname=k8s-node1
                    kubernetes.io/os=linux
Annotations:        flannel.alpha.coreos.com/backend-data: {&quot;VtepMAC&quot;:&quot;16:5c:40:b1:14:b6&quot;}
                    flannel.alpha.coreos.com/backend-type: vxlan
                    flannel.alpha.coreos.com/kube-subnet-manager: true
                    flannel.alpha.coreos.com/public-ip: 10.0.2.15
                    kubeadm.alpha.kubernetes.io/cri-socket: /var/run/dockershim.sock
                    node.alpha.kubernetes.io/ttl: 0
                    volumes.kubernetes.io/controller-managed-attach-detach: true
CreationTimestamp:  Sun, 20 Oct 2019 10:11:03 +0800
Taints:             &lt;none&gt;
Unschedulable:      false
Conditions:
  Type             Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
  ----             ------  -----------------                 ------------------                ------                       -------
  MemoryPressure   False   Sun, 20 Oct 2019 10:28:08 +0800   Sun, 20 Oct 2019 10:11:03 +0800   KubeletHasSufficientMemory   kubelet has sufficient memory available
  DiskPressure     False   Sun, 20 Oct 2019 10:28:08 +0800   Sun, 20 Oct 2019 10:11:03 +0800   KubeletHasNoDiskPressure     kubelet has no disk pressure
  PIDPressure      False   Sun, 20 Oct 2019 10:28:08 +0800   Sun, 20 Oct 2019 10:11:03 +0800   KubeletHasSufficientPID      kubelet has sufficient PID available
  Ready            True    Sun, 20 Oct 2019 10:28:08 +0800   Sun, 20 Oct 2019 10:11:34 +0800   KubeletReady                 kubelet is posting ready status
Addresses:
  InternalIP:  10.0.2.15
  Hostname:    k8s-node1
Capacity:
 cpu:                1
 ephemeral-storage:  41921540Ki
 hugepages-2Mi:      0
 memory:             1882296Ki
 pods:               110
Allocatable:
 cpu:                1
 ephemeral-storage:  38634891201
 hugepages-2Mi:      0
 memory:             1779896Ki
 pods:               110
System Info:
 Machine ID:                 5d806dde9b0444bdb5c9800a228267d8
 System UUID:                5D806DDE-9B04-44BD-B5C9-800A228267D8
 Boot ID:                    e6b7222c-686c-49cb-8e56-9bb263852d36
 Kernel Version:             3.10.0-957.12.2.el7.x86_64
 OS Image:                   CentOS Linux 7 (Core)
 Operating System:           linux
 Architecture:               amd64
 Container Runtime Version:  docker://18.9.8
 Kubelet Version:            v1.16.2
 Kube-Proxy Version:         v1.16.2
PodCIDR:                     172.100.1.0/24
PodCIDRs:                    172.100.1.0/24
Non-terminated Pods:         (4 in total)
  Namespace                  Name                              CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE
  ---------                  ----                              ------------  ----------  ---------------  -------------  ---
  default                    nginx-deployment-9f46bb5-7vlb7    0 (0%)        0 (0%)      0 (0%)           0 (0%)         3m53s
  default                    nginx-deployment-9f46bb5-c7czx    0 (0%)        0 (0%)      0 (0%)           0 (0%)         6m35s
  kube-system                kube-flannel-ds-amd64-6fwg5       100m (10%)    100m (10%)  50Mi (2%)        50Mi (2%)      17m
  kube-system                kube-proxy-cdcs4                  0 (0%)        0 (0%)      0 (0%)           0 (0%)         17m
Allocated resources:
  (Total limits may be over 100 percent, i.e., overcommitted.)
  Resource           Requests    Limits
  --------           --------    ------
  cpu                100m (10%)  100m (10%)
  memory             50Mi (2%)   50Mi (2%)
  ephemeral-storage  0 (0%)      0 (0%)
Events:
  Type    Reason                   Age   From                   Message
  ----    ------                   ----  ----                   -------
  Normal  Starting                 17m   kubelet, k8s-node1     Starting kubelet.
  Normal  NodeHasSufficientMemory  17m   kubelet, k8s-node1     Node k8s-node1 status is now: NodeHasSufficientMemory
  Normal  NodeHasNoDiskPressure    17m   kubelet, k8s-node1     Node k8s-node1 status is now: NodeHasNoDiskPressure
  Normal  NodeHasSufficientPID     17m   kubelet, k8s-node1     Node k8s-node1 status is now: NodeHasSufficientPID
  Normal  NodeAllocatableEnforced  17m   kubelet, k8s-node1     Updated Node Allocatable limit across pods
  Normal  Starting                 17m   kube-proxy, k8s-node1  Starting kube-proxy.
  Normal  NodeReady                16m   kubelet, k8s-node1     Node k8s-node1 status is now: NodeReady


Name:               k8s-node2
Roles:              &lt;none&gt;
Labels:             beta.kubernetes.io/arch=amd64
                    beta.kubernetes.io/os=linux
                    kubernetes.io/arch=amd64
                    kubernetes.io/hostname=k8s-node2
                    kubernetes.io/os=linux
Annotations:        flannel.alpha.coreos.com/backend-data: {&quot;VtepMAC&quot;:&quot;76:49:24:1f:e5:d6&quot;}
                    flannel.alpha.coreos.com/backend-type: vxlan
                    flannel.alpha.coreos.com/kube-subnet-manager: true
                    flannel.alpha.coreos.com/public-ip: 10.0.2.15
                    kubeadm.alpha.kubernetes.io/cri-socket: /var/run/dockershim.sock
                    node.alpha.kubernetes.io/ttl: 0
                    volumes.kubernetes.io/controller-managed-attach-detach: true
CreationTimestamp:  Sun, 20 Oct 2019 10:11:09 +0800
Taints:             &lt;none&gt;
Unschedulable:      false
Conditions:
  Type             Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
  ----             ------  -----------------                 ------------------                ------                       -------
  MemoryPressure   False   Sun, 20 Oct 2019 10:27:42 +0800   Sun, 20 Oct 2019 10:11:09 +0800   KubeletHasSufficientMemory   kubelet has sufficient memory available
  DiskPressure     False   Sun, 20 Oct 2019 10:27:42 +0800   Sun, 20 Oct 2019 10:11:09 +0800   KubeletHasNoDiskPressure     kubelet has no disk pressure
  PIDPressure      False   Sun, 20 Oct 2019 10:27:42 +0800   Sun, 20 Oct 2019 10:11:09 +0800   KubeletHasSufficientPID      kubelet has sufficient PID available
  Ready            True    Sun, 20 Oct 2019 10:27:42 +0800   Sun, 20 Oct 2019 10:11:40 +0800   KubeletReady                 kubelet is posting ready status
Addresses:
  InternalIP:  10.0.2.15
  Hostname:    k8s-node2
Capacity:
 cpu:                1
 ephemeral-storage:  41921540Ki
 hugepages-2Mi:      0
 memory:             1882296Ki
 pods:               110
Allocatable:
 cpu:                1
 ephemeral-storage:  38634891201
 hugepages-2Mi:      0
 memory:             1779896Ki
 pods:               110
System Info:
 Machine ID:                 7c59ba12638e4fdfa20cfeda0aa2fda1
 System UUID:                7C59BA12-638E-4FDF-A20C-FEDA0AA2FDA1
 Boot ID:                    e402f75c-42e7-454d-aaca-f96853091c15
 Kernel Version:             3.10.0-957.12.2.el7.x86_64
 OS Image:                   CentOS Linux 7 (Core)
 Operating System:           linux
 Architecture:               amd64
 Container Runtime Version:  docker://18.9.8
 Kubelet Version:            v1.16.2
 Kube-Proxy Version:         v1.16.2
PodCIDR:                     172.100.2.0/24
PodCIDRs:                    172.100.2.0/24
Non-terminated Pods:         (3 in total)
  Namespace                  Name                              CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE
  ---------                  ----                              ------------  ----------  ---------------  -------------  ---
  default                    nginx-deployment-9f46bb5-mv4b7    0 (0%)        0 (0%)      0 (0%)           0 (0%)         5m52s
  kube-system                kube-flannel-ds-amd64-z4plh       100m (10%)    100m (10%)  50Mi (2%)        50Mi (2%)      17m
  kube-system                kube-proxy-nlmbb                  0 (0%)        0 (0%)      0 (0%)           0 (0%)         17m
Allocated resources:
  (Total limits may be over 100 percent, i.e., overcommitted.)
  Resource           Requests    Limits
  --------           --------    ------
  cpu                100m (10%)  100m (10%)
  memory             50Mi (2%)   50Mi (2%)
  ephemeral-storage  0 (0%)      0 (0%)
Events:
  Type    Reason                   Age   From                   Message
  ----    ------                   ----  ----                   -------
  Normal  Starting                 17m   kubelet, k8s-node2     Starting kubelet.
  Normal  NodeHasSufficientMemory  17m   kubelet, k8s-node2     Node k8s-node2 status is now: NodeHasSufficientMemory
  Normal  NodeHasNoDiskPressure    17m   kubelet, k8s-node2     Node k8s-node2 status is now: NodeHasNoDiskPressure
  Normal  NodeHasSufficientPID     17m   kubelet, k8s-node2     Node k8s-node2 status is now: NodeHasSufficientPID
  Normal  NodeAllocatableEnforced  17m   kubelet, k8s-node2     Updated Node Allocatable limit across pods
  Normal  Starting                 17m   kube-proxy, k8s-node2  Starting kube-proxy.
  Normal  NodeReady                16m   kubelet, k8s-node2     Node k8s-node2 status is now: NodeReady
</code></pre>
<h2 id="服务伸缩">服务伸缩</h2>
<h3 id="scale命令方式"><code>scale</code>命令方式</h3>
<pre><code class="language-bash">$ kubectl scale --replicas=6 deployment/nginx-deployment
deployment.apps/nginx-deployment scaled
</code></pre>
<h3 id="查看副本数">查看副本数</h3>
<pre><code class="language-bash">$ kubectl get replicaset
NAME                          DESIRED   CURRENT   READY   AGE
nginx-deployment-54f57cf6bf   0         0         0       21m
nginx-deployment-56f8998dbc   6         6         3       5m7s
nginx-deployment-9f46bb5      0         0         0       16m
</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                        <div class="next-post">
                            <div class="next">下一篇</div>
                            <a href="https://fjiayang.github.io//post/kubernetes-ji-qun-da-jian">
                                <h3 class="post-title">
                                    Kubernetes 集群搭建
                                </h3>
                            </a>
                        </div>
                        
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">目录</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E9%85%8D%E7%BD%AE%E5%91%BD%E4%BB%A4%E8%AF%AD%E6%B3%95%E6%8F%90%E7%A4%BA">配置命令语法提示</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E4%B8%8A%E4%B8%8B%E6%96%87%E7%8E%AF%E5%A2%83">配置多个上下文环境</a></li>
<li><a href="#pod%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C">Pod相关操作</a>
<ul>
<li><a href="#%E9%BB%98%E8%AE%A4%E6%9F%A5%E7%9C%8Bdefault%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%9A%84pod">默认查看<code>default</code>命名空间的Pod</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%9A%84pod">查看所有命名空间的Pod</a></li>
<li><a href="#%E6%8C%87%E5%AE%9Apod%E5%AF%B9%E5%BA%94%E7%9A%84app%E5%90%8D%E7%A7%B0">指定Pod对应的app名称</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%9B%B4%E5%A4%9A%E4%BF%A1%E6%81%AF">查看更多信息</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8Bpod%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF">查看Pod详细信息</a></li>
</ul>
</li>
<li><a href="#deployment%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C">Deployment相关操作</a>
<ul>
<li><a href="#%E9%83%A8%E7%BD%B2deployment">部署Deployment</a></li>
<li><a href="#%E5%8D%87%E7%BA%A7deployment">升级Deployment</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8Bdeployment%E6%9B%B4%E5%A4%9A%E4%BF%A1%E6%81%AF">查看Deployment更多信息</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF">查看详细信息</a></li>
</ul>
</li>
<li><a href="#node%E7%9B%B8%E5%85%B3">Node相关</a>
<ul>
<li><a href="#%E6%9F%A5%E7%9C%8Bnode">查看Node</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%9B%B4%E5%A4%9A%E4%BF%A1%E6%81%AF-2">查看更多信息</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%A0%87%E7%AD%BE">查看标签</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E8%A7%92%E8%89%B2%E6%A0%87%E7%AD%BE">设置角色标签</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF-2">查看详细信息</a></li>
</ul>
</li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E4%BC%B8%E7%BC%A9">服务伸缩</a>
<ul>
<li><a href="#scale%E5%91%BD%E4%BB%A4%E6%96%B9%E5%BC%8F"><code>scale</code>命令方式</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%89%AF%E6%9C%AC%E6%95%B0">查看副本数</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*获取文章目录集合,可通过:header过滤器*/
                var alis = $('.post-content :header');
                /*获取侧边栏目录列表集合**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*获取滚动条到顶部的距离*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*获取锚点集合中的元素分别到顶点的距离*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*高亮显示*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*绑定滚动事件 */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<!--覆盖默认样式-->
<style type="text/css">
			.header {   
					height:64px !important;
			}
			.post-title{
					border:none !important;
			}
			.btn-text{    
					width: 80px;
					height: 18px;
					overflow: hidden;
			}
			.site-title h1{
					font-weight:400 !important;
					margin-left:10px !important;
					margin-right:0 !inportant;
			}

			.id_card .id_card-avatar{
					padding:4px !important;
			}
			.post-content-abstract{
					max-width: 600px !important;
					max-height: 100px !important;
					overflow: hidden;
			}
			.post-content-abstract *{
					font-size:14px !important;
					display:inline-block !important;
					margin:0 0 2px 0 !important;
					font-weight:300 !important;
			}

</style> | 
  <a class="rss" href="https://fjiayang.github.io//atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>